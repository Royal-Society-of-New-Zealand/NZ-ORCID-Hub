{% extends "base.html" %}
{% from "macros.html" import render_field %}

{% block content %}
  <h1>Onboard Organisation</h1>
  <form method="POST">
    {{ form.hidden_tag() }}
    {{ render_field(form.org_name) }}
    {{ render_field(form.org_email, autocomplete="on") }}
    <div class="row">
      <div class="col-md-6 col-sm-6 col-xs-12">
        {{ render_field(form.tech_contact) }}
      </div>
      <div class="col-md-6 col-sm-6 col-xs-12">
        {{ render_field(form.via_orcid, data_toggle="collapse", data_target="#user-details") }}
      </div>
    </div>
    <div class="{{'row' if form.via_orcid.data else 'row collapse'}}" id="user-details">
      <div class="col-md-6 col-sm-6 col-xs-12">
        {{ render_field(form.first_name) }}
        {{ render_field(form.last_name) }}
        {{ render_field(form.orcid_id) }}
        {{ render_field(form.disambiguation_org_id) }}
      </div>
      <div class="col-md-6 col-sm-6 col-xs-12">
        {{ render_field(form.city) }}
        {{ render_field(form.state) }}
        {{ render_field(form.country) }}
        {{ render_field(form.disambiguation_org_source) }}
      </div>
    </div>
    <button type="submit" class="btn btn-default" value="Onboard Organisation">Onboard Organisation</button>
  </form>
{% endblock %}
{% block footer %}
  {{ super() }}
  <script>
$( function() {
  var orgInfo = {{ org_info | tojson }};
  $( "#org_name" ).autocomplete({
    source: Object.keys(orgInfo),
    select: function(event, ui) {
      $("#org_email").val(orgInfo[ui.item.value]);
      $("#org_email").focus();
    }
  });
  /* $("#via_orcid").change(function() { */
  /*   if(this.checked) { */
  /*       //Do stuff */
  /*   } */
  /* }); */
});
  </script>
{% endblock %}

